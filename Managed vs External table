ğŸ“Œ Spark SQL â€“ Managed Tables vs External Tables

ğŸ”¹ Ownership
- Managed Table: Spark owns both metadata and data
- External Table: Spark owns only the metadata; data is stored externally

ğŸ”¹ Drop Behavior
- Managed Table: Dropping deletes both metadata and data
- External Table: Dropping deletes only metadata; data remains untouched

ğŸ”¹ External Table Storage
External tables store data in external systems such as:
- S3 (Amazon Simple Storage Service)
- ADLS (Azure Data Lake Storage)
- HDFS (Hadoop Distributed File System)
- Local/Network file paths

ğŸ”¹ Create Table

-- Managed Table
spark.sql("""
    CREATE TABLE IF NOT EXISTS employees (
        id INT,
        name STRING,
        department STRING
    )
""")

-- External Table (CSV from ADLS or S3)
spark.sql("""
    CREATE TABLE IF NOT EXISTS ext_employees (
        id INT,
        name STRING,
        department STRING
    )
    USING CSV
    OPTIONS (path "abfss://data@storageaccount.dfs.core.windows.net/employees", header "true", inferSchema "true")
""")

ğŸ”¹ Drop Table

-- Managed Table
spark.sql("DROP TABLE IF EXISTS employees")

-- External Table
spark.sql("DROP TABLE IF EXISTS ext_employees")

ğŸ”¹ DML Support

Operation       | Managed Table | External Table (Open-Source) | External Table (Databricks)
----------------|----------------|------------------------------|------------------------------
INSERT          | âœ… Works        | âœ… Works                     | âœ… Works
UPDATE          | âŒ Not Supported| âŒ Not Supported             | âœ… Works
DELETE          | âŒ Not Supported| âŒ Not Supported             | âœ… Works
SELECT          | âœ… Works        | âœ… Works                     | âœ… Works
